# 理解JS中的类

## 前言
刚开始工作的时候, 做的是Java开发. 机缘巧合之下, 转做了前端开发, 至今已有两年时间. 着两年的前端开发经历,最大的感觉就是: 即使不知道如何在JS中定义一个类, 依然能做好自己的工作. 当然, 这并不代表不需要知道. 当经验与实力达到一个更高的层次的时候, 需要考虑的就不仅仅是如何去实现, 而是为什么是这么实现的. 这将会驱使着自己跳出具体的开发场景, 而去探究更深层次的东西. 如果有机会看过某些框架的实现, 就会发现里面有各种各样的创建一个JS类的方式. 看到它们, 仿佛进入了一个新世界, 有种似曾相识但却说不出在哪见过的感觉. 但正是这种感觉, 驱使着自己去探究. 那么今天, 希望我能用这寥寥数语, 为你的新世界指引一个方向.

## 一个最简单的类
下面这段代码, 应该就是在JS中能见到的最简单的类了吧.
```js
function Cat () {

}

let cat = new Cat()
```
当第一眼看到这个的时候, 相信每一个前端的第一感觉就是: 这不就是一个函数吗? 确实, 它和日常定义的函数的最大区别, 可能就是一般情况下函数名的首字母是小写的. 当我第一次看到这个的时候, 也是这种感觉. 但这种困惑, 在之后的工作中得到了解决.   
在JS中, 函数是一等公民. 是作为一个类, 还是作为一个函数, 取决它的调用方式. 如果是使用 __new__ 关键字来调用, 那么它就是一个类, 与之相对的, 如果是以一个普通的函数方式来调用的, 那它就是一个函数. 但是为了将普通函数与类做一个肉眼可见的区分, 也是为了能与其他语言统一, 通常会将作为类的函数的函数名首字母大写.

## 一个最普通的类
将上面的代码稍加改造, 就是下面的这个最普通的类
```js
function Cat (name) {
    this.name = name
    this.sleep = function () {
        console.log(this.name, ' is sleeping')
    }
}

let cat = new Cat('kate')

console.log(cat.name)
// kate
cat.sleep()
// kate is sleeping
```
与上面的类相比, `Cat`中多了几行代码, 在`this`上定义了一个属性`name`, 定义了一个函数`sleep`(在这里使用方法这一词更加准确, 但不管怎么称呼, 都没有什么影响, 但为了规范, 下面会统一使用方法这一词). 这里, 我们使用了`new`关键字创建了类`Cat`的一个实例`cat`, 并访问了`cat`的`name`属性, 调用了它的`sleep`方法. 从结果中可以看出, `this`指代的就是创建的这个`cat`实例. 在其他的高级语言中, 也能看到很多类似的写法. 至此, 我们定义了一个有所作为的类. 但仅仅是这样, 能够满足工作中的需要吗?
## 一个稍微有些不正常的类
下面的代码中, 与上面相比, 又多了一个新的东西: `prototype`.
```js
function Cat (name) {
    this.name = name
    this.sleep = function () {
        console.log(this.name, ' is sleeping')
    }
}
Cat.prototype.miaow = function () {
    console.log(this.name , ' miaow')
}

let cat = new Cat('kate')

console.log(cat.name)
// kate
cat.sleep()
// kate is sleeping
cat.miaow()
// kate miaow
```
与上面相比, 在`Cat`的`prototype`上定义了一个名为`miaow`的方法. 在这里, 前面的两个输出, 通过上面的示例, 结果是显而易见的. 最让人不解的就是第三个`cat.miaow()`的输出值. 这里的`prototype`是干什么的, 这个`this`又是从哪里来的. 这个问题, 如果你看书, 书上会告诉你: `prototype`是`Cat`的原型, 因为在`JS`中, 类是通过原型链来实现继承关系的. 每一个构造函数都拥有一个`prototype`属性，这个属性指向一个对象，也就是原型对象。当使用这个构造函数创建实例的时候，`prototype`属性指向的原型对象就成为实例的原型对象. 亦或会给你一张类似于下面的这张图, 来解释实例, 类和原型之间的关系, 以及由它们组成的一个原型链.

![]()
![]()
看到类似于这样的图, 感觉要被绕晕了. 虽然解释很明白, 但是还是没有解决心中的困惑啊. 耳听为虚, 眼见为实, 在真实的环境中看到结果, 才能有更加清醒的认识.