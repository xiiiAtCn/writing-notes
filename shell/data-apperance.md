#### 输入和输出
两种显示脚本输出的方法:  
1. 在显示器屏幕上显示输出
2. 将输出重定向到文件中

##### 标准文件描述符
Linux系统将每个对象当作文件处理. 这包括输入和输出进程. Linux用文件描述符(file descriptor)来标识每个文件对象. 文件描述符是一个非负整数, 可以唯一标识会话中打开的文件. 每个进程一次最多可以有九个文件描述符. 出于特殊目的, bash shell保留了前三个文件描述符.  

|文件描述符|缩写|描述|
|---|---|---|
|0|STDIN|标准输入|
|1|STDOUT|标准输出|
|2|STDERR|标准错误|

1. STDIN  
STDIN文件描述符代表shell的标准输入. 对终端来说, 标准输入是键盘. shell从STDIN文件描述符对应的键盘获得输入, 在用户输入时处理每个字符. 在使用输入重定向符号(<)时, Linux会用重定向指定的文件替换标准输入文件描述符. 有些命令可以接受STDIN输入的数据, 如cat
2. STDOUT  
STDOUT文件描述符代表shell的标准输出. 在终端界面上, 标准输出就是终端显示器. shell对于错误消息的处理是跟普通输出分开的. 
3. STDERR  
shell通过特殊的STDERR文件描述符来处理错误消息. 默认情况下, STDERR文件描述符会和STDOUT文件描述符指向同样的地方. 但STDERR并不会随着STDOUT的重定向而发生改变. 

##### 重定向错误
1. 只重定向错误  
示例: 
```
    ls -al badfile 2> test4
```
2. 重定向错误和数据  
示例:
```
    ls -al test test2 2>test6 1>test7
```
将STEDRR和STDOUT的输出重定向到同一个文件. 需要一个特殊的重定向符号&>
示例: 
```
    ls -al test test1 test2 &>test8
```

#### 在脚本中重定向输出
1. 临时重定向  
如果有意在脚本中生成一条错误信息, 可以将单独的一行输出重定向到STDERR. 需要做的是使用输出重定向符来将输出信息重定向到STDERR文件描述符. 在重定向到文件描述符时, 必须在文件描述符数字之前加一个&
2. 永久重定向  
大量数据需要重定向, 则可以用exec命令告诉shell在脚本执行期间重定向某个特定文件描述符. exec命令会启动一个新shell并将STDERR文件描述符重定向到文件. 一旦重定向了STDOUT或STDERR, 就很难再将它们重定向回原来的位置. 

#### 重定向脚本输入
exec命令允许将STDIN重定向到Linux系统上的文件中
```
    exec 0< testfile
```
#### 创建自己的重定向
其他3~8的文件描述符均可用作输入或输出重定向. 可以将这些文件描述符中的任意一个分配给文件, 然后在脚本中使用它们. 可以理解为0~2为初始化了的引用, 而3~8为预定义, 但并未初始化的引用.
##### 创建输出文件描述符
可以用exec命令来给输出分配文件描述符.

##### 重定向文件描述符
可以分配另外一个文件描述符给标准文件描述符, 反之亦然. 这意味着可以将STDOUT的原来位置重定向到另一个文件描述符.

##### 创建输入文件描述符
可以用和重定向输出文件描述符同样的办法重定向输入文件描述符. 在重定向到文件之前, 先将STDIN文件描述符保存到另外一个文件描述符, 然后在读取完文件之后再将STDIN恢复到它原来的位置.

##### 创建读写文件描述符
可以用同一个文件描述符对同一个文件进行读写. shell会维护一个内部指针, 指明在文件中的当前位置. 任何读写都会从文件指针上次的位置开始.

##### 关闭文件描述符
shell会在脚本退出时自动关闭创建的新的输入或输出文件描述符. 但在有些情况下, 需要你在脚本结束前手动关闭文件描述符.  
要关闭文件描述符, 需要将它重定向到特殊符号&-
```
    exec 3 >&-
```

##### 列出打开的文件描述符
lsof命令会列出真个Linux系统打开的所有文件描述符. 它会显示当前Linux系统上打开的每个文件的有关信息. 着包括后台运行的所有进程及登录到系统的任何用户. 要想知道当前进程的PID, 可以用特殊环境变量$$. -a选项用来对其他两个选项的结果指定布尔AND运算. lsof的默认输出中有7列信息

|列|描述|
|COMMAND|正在运行的命令名的前9个字符|
|PID|进程的PID|
|USER|进程属主的登录名|
|FD|文件描述符以及访问类型(r代表读, w代表写, u代表读写)|
|TYPE|文件的类型(CHR代表字符型, BLK代表块型, DIR代表目录, REG代表常规文件)|
|DEVICE|设备的设备号(主设备号和从设备号)|
|SIZE|如果有的话, 代表文件的大小|
|NODE|本地文件的节点号|
|NAME|文件名|

#### 阻止命令输出
如果运行在后台的脚本出现错误信息, shell会通过电子邮件将它们发给进程的属主. 要解决这个问题, 可以将STDERR重定向到一个叫作null文件的特殊文件. shell输出到null文件的任何数据都不会保存, 全部被丢掉了. 在Linux系统上null文件的标准位置是/etc/null. 重定向此处的任何数据都会被丢掉, 不会显示.

#### 创建临时文件
Linux使用/tmp目录来存放不需要永久保留的文件. 大多数Linux发行版配置了系统在启动时自动删除/tmp目录的所有文件.  
系统上的任何用户账户都有权限在读写/tmp目录中的文件. 有个特殊命令可以用来创建临时文件. mktemp命令可以在/tmp目录中创建一个唯一的临时文件. shell会创建这个文件. 它会将文件的读和写权限分配给文件的属主, 并将你设成文件的属主.

##### 创建本地临时文件
默认情况下, mktemp会在本地目录中创建一个文件.
```
mktemp testing.XXXXXX
```

##### 在/tmp目录创建临时文件
-t选项会强制mktemp命令来在系统的临时目录来创建该文件.

##### 创建临时目录
-d选项告诉mktemp命令来创建一个临时目录而不是临时文件.

#### 记录消息
将输出同时发送到显示器和日志文件, 你不用将输出重定向两次, 只要用特殊的tee命令就行. tee命令相当于管道的一个T型接头. 它将STDIN过来的数据同时发往两处. 一处是STDOUT, 另一处是tee命令行所指定的文件名. 如果需要数据追加到文件中, 必须用-a选项.




















