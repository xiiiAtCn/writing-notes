---
title: base64编码
date: 2018-2-25
tags: encode
categories: fundmental
---
最近在做关于命令行下载资源的工具时, 遇到了关于中文base64编码后解码出错的问题, 然后就仔细了解了一下关于base64编码的方式.  
#### base64的编码转换方式
base64总共选取了64个字符: 小写字母a-z, 大写字母A-Z, 数字0-9(再加上一个补充字符"=", 实际上是65个字符), 作为一个基本的字符集.然后, 将其他所有的符号都转换成由这些字符组成的字符集.具体操作分为以下四步:
1. 将字符集按每三个字节分为一组(不足三个字节的特殊处理), 一共是24个二进制位.
2. 将这24个二进制分为4组, 每组为一个6位二进制值
3. 在每组值前面添加两个0, 即将每组值变位一个8位二进制值, 即一个字节
4. 然后根据对应规则, 得到每个字节对应的字符, 即得到Base64的编码值  
对应规则如下表所示  

|||||||||||||||||
|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|:----|
|A|B|C|D|E|F|G|H|I|J|K|L|M|N|O|P|
|0|1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|
|Q|R|S|T|U|V|W|X|Y|Z|a|b|c|d|e|f|
|16|17|18|19|20|21|22|23|24|25|26|27|28|29|30|31|
|g|h|i|j|k|l|m|n|o|p|q|r|s|t|u|v|
|32|33|34|35|36|37|38|39|40|41|42|43|44|45|46|47|
|w|x|y|z|0|1|2|3|4|5|6|7|8|9|+|/|
|48|49|50|51|52|53|54|55|56|57|58|59|60|61|62|63|

对于字节数不足3位的情况, 分以下两中情况分别处理:  

1. 两个字节: 将这两个字节按照上面的规则转成三组, 然后给最后一组后面加上两个0, 按照base64的对应规则得到对应字符, 再在后面加上一个等号(=)
```
示例
by: 98 121
1. 0110 0010 0111 1001
2. 011000 100111 1001
3. 00011000 00101111 00100100
4. Ynk
5. Ynk=
```
2. 一个字节: 将这一个字节按照上面的规则转成两组, 然后给最后一组后面加上四个0, 按照base64的对应规则得到编码后的值之后, 再在后面加上两个等号(=)
```
示例
b: 98
1. 0110 0010
2. 011000 10
3. 00011000 00100000
4. Yg
5. Yg==
```